---
title: 实体-属性-值（EAV）模式：一种灵活的数据建模方法
---

# 实体-属性-值（EAV）模式：一种灵活的数据建模方法

## 简介

实体-属性-值（Entity-Attribute-Value，简称EAV）是一种数据模型，用于描述实体。 它允许使用大量属性（properties and parameters）来描述实体，但在实践中，只有相对较少的属性会应用于给定的实体。 这种模型有效地管理和组织数据，确保了灵活性和可伸缩性，同时保持描述的简洁性和相关性。 有时它也被称为开放模式（open schema）或对象-属性-值（object-attribute-value）模型。

EAV模型在实体具有潜在无限数量属性的场景中是一种灵活的数据模型。 这种模型在需要收集大量不同属性的行业中很受欢迎，例如医疗保健和电子商务。

## EAV模型的三个核心组成部分

EAV模型主要由三个部分组成：

* **实体（Entity）**：被描述的对象。 例如，在一个医疗记录数据库中，一个“病人”就是一个实体。
* **属性（Attribute）**：实体的某个特征或参数。 比如病人的“血压”、“年龄”或“病症”。
* **值（Value）**：特定实体对应属性的具体数值。

在一个EAV数据模型中，每个“属性-值”对都描述了实体的一个事实，而EAV表中的每一行都存储一个单一的事实。 EAV表通常被描述为“又长又窄”：“长”指的是行数多，“窄”指的是列数少。

## EAV模型的应用场景

EAV模型适用于那些定义了大量或丰富的属性类型，而这些属性又适用于广泛的实体集合，但通常只有一个小的、特定的子集会为给定实体实例化（或持久化）的应用程序。 因此，这种数据模型与稀疏矩阵的数学概念有关。

## EAV模型的优缺点

### 优点

* **高度的灵活性**：EAV模型最显著的优点是其添加新属性的灵活性。 你可以轻松地为产品或实体添加新的属性，而无需更改数据库结构。
* **可扩展性**：随着业务的增长，EAV模型能够很好地适应变化，支持更多的属性和实体类型。
* **高效的存储空间利用**：EAV模型通过只存储使用中的属性值来优化存储，与传统的“扁平”模型相比节省了空间。

### 缺点

* **数据验证困难**：在生产系统中，允许直接向EAV表输入数据是灾难性的，因为数据库引擎本身无法执行稳健的输入验证。 值的概念性数据类型取决于该行中的属性。
* **查询复杂性**：从EAV模型中检索数据通常比在传统的关系型数据库中更复杂，可能需要复杂的连接和转换操作。
* **数据类型不一致**：EAV表中的“值”列通常是通用的数据类型（如字符串），这可能导致数据类型转换和比较的困难。

## 结论

EAV模型是一种强大而灵活的数据建模方法，特别适用于属性稀疏且经常变化的场景。 然而，它的灵活性也带来了一些复杂性，尤其是在数据验证和查询方面。 因此，在使用EAV模型时，需要仔细权衡其优缺点，并结合具体的业务需求来决定是否采用。 在许多情况下，将EAV模型与传统的ER模型（实体-关系模型）结合使用，可以在同一个数据库模式中实现两全其美。